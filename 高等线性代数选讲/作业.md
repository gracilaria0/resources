## 7 相似标准型
### 7.5 初等因子
#### 7.5.1
**已知矩阵的不变因子组，求它的初等因子组（分别在有理数域、实数域与复数域上）：**
##### (1)
$`1, \cdots, 1, \lambda, \lambda^2\left(\lambda-1\right), \lambda^2\left(\lambda-1\right)^3\left(\lambda+1\right)`$；

$-1,0,1 \in \mathbb{Q} \subset \mathbb{R} \subset \mathbb{C}$，所以在$`\mathbb{Q}, \mathbb{R}, \mathbb{C}`$上，都有

$`\begin{eqnarray}
	d_1\left(\lambda\right) &=& 1 &=& \lambda^0 & \left(\lambda-1\right)^0 & \left(\lambda+1\right)^0, \\
	& \vdots \\
	d_{k-3}\left(\lambda\right) &=& 1 &=& \lambda^0 & \left(\lambda-1\right)^0 & \left(\lambda+1\right)^0, \\
	d_{k-2}\left(\lambda\right) &=& \lambda &=& \lambda^1 & \left(\lambda-1\right)^0 & \left(\lambda+1\right)^0, \\
	d_{k-1}\left(\lambda\right) &=& \lambda^2\left(\lambda-1\right) &=& \lambda^2 & \left(\lambda-1\right)^1 & \left(\lambda+1\right)^0, \\
	d_k\left(\lambda\right) &=& \lambda^2\left(\lambda-1\right)^3\left(\lambda+1\right) &=& \lambda^2 & \left(\lambda-1\right)^3 & \left(\lambda+1\right)^1, \\
\end{eqnarray}`$

所以在矩阵在$`\mathbb{Q}, \mathbb{R}, \mathbb{C}`$上的初等因子组都是$`\lambda, \lambda^2, \lambda-1, \lambda^2, \left(\lambda-1\right)^3, \lambda+1`$。

  
##### (2)
$`1, \cdots, 1, \lambda^2+1, \lambda\left(\lambda^2+1\right)^2, \lambda^2\left(\lambda^4-1\right)^2`$；

在$`\mathbb{C}`$上，有

$`\begin{eqnarray}
	\lambda^2+1 &=& \left(\lambda-\mathrm{i}\right) \left(\lambda+\mathrm{i}\right), \\
	\lambda^4-1 &=& \left(\lambda-1\right) \left(\lambda+1\right) \left(\lambda-\mathrm{i}\right) \left(\lambda+\mathrm{i}\right)
\end{eqnarray}`$

其中$`-\mathrm{i}, \mathrm{i} \in \mathbb{C} \setminus \mathbb{R}`$，所以

###### (a)在$`\mathbb{Q}, \mathbb{R}`$上，
$`\begin{eqnarray}
	d_1\left(\lambda\right) &=& 1 &=& \lambda^0 & \left(\lambda-1\right)^0 & \left(\lambda+1\right)^0 & \left(\lambda^2+1\right)^0, \\
	& \vdots \\
	d_{k-3}\left(\lambda\right) &=& 1 &=& \lambda^0 & \left(\lambda-1\right)^0 & \left(\lambda+1\right)^0 & \left(\lambda^2+1\right)^0, \\
	d_{k-2}\left(\lambda\right) &=& \lambda^2+1 &=& \lambda^0 & \left(\lambda-1\right)^0 & \left(\lambda+1\right)^0 & \left(\lambda^2+1\right)^1, \\
	d_{k-1}\left(\lambda\right) &=& \lambda\left(\lambda^2+1\right)^2 &=& \lambda^1 & \left(\lambda-1\right)^0 & \left(\lambda+1\right)^0 & \left(\lambda^2+1\right)^2, \\
	d_k\left(\lambda\right) &=& \lambda^2\left(\lambda^4-1\right)^2 &=& \lambda^2 & \left(\lambda-1\right)^2 & \left(\lambda+1\right)^2 & \left(\lambda^2+1\right)^2
\end{eqnarray}`$

所以在$`\mathbb{Q}, \mathbb{R}`$上，矩阵的初等因子组都是$`\lambda^2+1, \lambda, \lambda^2+1, \lambda^2, \left(\lambda-1\right)^2, \left(\lambda+1\right)^2, \left(\lambda^2+1\right)^2`$。

###### (b)在$`\mathbb{C}`$上，
$`\begin{eqnarray}
	d_1\left(\lambda\right) &=& 1 &=& \lambda^0 & \left(\lambda-1\right)^0 & \left(\lambda+1\right)^0 & \left(\lambda-\mathrm{i}\right)^0 & \left(\lambda+\mathrm{i}\right)^0, \\
	& \vdots \\
	d_{k-3}\left(\lambda\right) &=& 1 &=& \lambda^0 & \left(\lambda-1\right)^0 & \left(\lambda+1\right)^0 & \left(\lambda-\mathrm{i}\right)^0 & \left(\lambda+\mathrm{i}\right)^0, \\
	d_{k-2}\left(\lambda\right) &=& \lambda^2+1 &=& \lambda^0 & \left(\lambda-1\right)^0 & \left(\lambda+1\right)^0 & \left(\lambda-\mathrm{i}\right)^1 & \left(\lambda+\mathrm{i}\right)^1, \\
	d_{k-1}\left(\lambda\right) &=& \lambda\left(\lambda^2+1\right)^2 &=& \lambda^1 & \left(\lambda-1\right)^0 & \left(\lambda+1\right)^0 & \left(\lambda-\mathrm{i}\right)^2 & \left(\lambda+\mathrm{i}\right)^2, \\
	d_k\left(\lambda\right) &=& \lambda^2\left(\lambda^4-1\right)^2 &=& \lambda^2 & \left(\lambda-1\right)^2 & \left(\lambda+1\right)^2 & \left(\lambda-\mathrm{i}\right)^2 & \left(\lambda+\mathrm{i}\right)^2
\end{eqnarray}`$

所以在$`\mathbb{C}`$上，矩阵的初等因子组是$`\lambda-\mathrm{i}, \lambda+\mathrm{i}, \lambda, \left(\lambda-\mathrm{i}\right)^2, \left(\lambda+\mathrm{i}\right)^2, \lambda^2, \left(\lambda-1\right)^2, \left(\lambda+1\right)^2, \left(\lambda-\mathrm{i}\right)^2, \left(\lambda+\mathrm{i}\right)^2`$。

  
##### (3)
$`1, \cdots, 1, \lambda\left(\lambda^2+1\right), \lambda^2\left(\lambda^2+1\right), \lambda^3\left(\lambda^2+1\right)^2\left(\lambda^2-2\right)`$。

在$`\mathbb{C}`$上，有

$`\begin{eqnarray}
	\lambda^2+1 &=& \left(\lambda-\mathrm{i}\right) \left(\lambda+\mathrm{i}\right), \\
	\lambda^2-2 &=& \left(\lambda-\sqrt{2}\right) \left(\lambda+\sqrt{2}\right)
\end{eqnarray}`$

其中$`-\sqrt{2}, \sqrt{2} \in \mathbb{R} \setminus \mathbb{Q}`$，$`-\mathrm{i}, \mathrm{i} \in \mathbb{C} \setminus \mathbb{R}`$，所以


###### (a)在$`\mathbb{Q}`$上，
$`\begin{eqnarray}
	d_1\left(\lambda\right) &=& 1 &=& \lambda^0 & \left(\lambda^2+1\right)^0 & \left(\lambda^2-2\right)^0, \\
	& \vdots \\
	d_{k-3}\left(\lambda\right) &=& 1 &=& \lambda^0 & \left(\lambda^2+1\right)^0 & \left(\lambda^2-2\right)^0, \\
	d_{k-2}\left(\lambda\right) &=& \lambda\left(\lambda^2+1\right) &=& \lambda^1 & \left(\lambda^2+1\right)^1 & \left(\lambda^2-2\right)^0, \\
	d_{k-1}\left(\lambda\right) &=& \lambda^2\left(\lambda^2+1\right) &=& \lambda^2 & \left(\lambda^2+1\right)^1 & \left(\lambda^2-2\right)^0, \\
	d_k\left(\lambda\right) &=& \lambda^3\left(\lambda^2+1\right)^2\left(\lambda^2-2\right) &=& \lambda^3 & \left(\lambda^2+1\right)^2 & \left(\lambda^2-2\right)^1
\end{eqnarray}`$

所以在$`\mathbb{C}`$上，矩阵的初等因子组是$`\lambda, \lambda^2+1, \lambda^2, \lambda^2+1, \lambda^3, \left(\lambda^2+1\right)^2, \lambda^2-2`$。


###### (b)在$`\mathbb{R}`$上，
$`\begin{eqnarray}
	d_1\left(\lambda\right) &=& 1 &=& \lambda^0 & \left(\lambda-\sqrt{2}\right)^0 & \left(\lambda+\sqrt{2}\right)^0 & \left(\lambda^2+1\right)^0, \\
	& \vdots \\
	d_{k-3}\left(\lambda\right) &=& 1 &=& \lambda^0 & \left(\lambda-\sqrt{2}\right)^0 & \left(\lambda+\sqrt{2}\right)^0 & \left(\lambda^2+1\right)^0, \\
	d_{k-2}\left(\lambda\right) &=& \lambda\left(\lambda^2+1\right) &=& \lambda^1 & \left(\lambda-\sqrt{2}\right)^0 & \left(\lambda+\sqrt{2}\right)^0 & \left(\lambda^2+1\right)^1, \\
	d_{k-1}\left(\lambda\right) &=& \lambda^2\left(\lambda^2+1\right) &=& \lambda^2 & \left(\lambda-\sqrt{2}\right)^0 & \left(\lambda+\sqrt{2}\right)^0 & \left(\lambda^2+1\right)^1, \\
	d_k\left(\lambda\right) &=& \lambda^3\left(\lambda^2+1\right)^2\left(\lambda^2-2\right) &=& \lambda^3 & \left(\lambda-\sqrt{2}\right)^1 & \left(\lambda+\sqrt{2}\right)^1 & \left(\lambda^2+1\right)^2
\end{eqnarray}`$

所以在$`\mathbb{C}`$上，矩阵的初等因子组是$`\lambda, \lambda^2+1, \lambda^2, \lambda^2+1, \lambda^3, \lambda-\sqrt{2}, \lambda+\sqrt{2}, \left(\lambda^2+1\right)^2`$。


###### (c)在$`\mathbb{C}`$上，
$`\begin{eqnarray}
	d_1\left(\lambda\right) &=& 1 &=& \lambda^0 & \left(\lambda-\sqrt{2}\right)^0 & \left(\lambda+\sqrt{2}\right)^0 & \left(\lambda-\mathrm{i}\right)^0 & \left(\lambda+\mathrm{i}\right)^0, \\
	& \vdots \\
	d_{k-3}\left(\lambda\right) &=& 1 &=& \lambda^0 & \left(\lambda-\sqrt{2}\right)^0 & \left(\lambda+\sqrt{2}\right)^0 & \left(\lambda-\mathrm{i}\right)^0 & \left(\lambda+\mathrm{i}\right)^0, \\
	d_{k-2}\left(\lambda\right) &=& \lambda\left(\lambda^2+1\right) &=& \lambda^1 & \left(\lambda-\sqrt{2}\right)^0 & \left(\lambda+\sqrt{2}\right)^0 & \left(\lambda-\mathrm{i}\right)^1 & \left(\lambda+\mathrm{i}\right)^1, \\
	d_{k-1}\left(\lambda\right) &=& \lambda^2\left(\lambda^2+1\right) &=& \lambda^2 & \left(\lambda-\sqrt{2}\right)^0 & \left(\lambda+\sqrt{2}\right)^0 & \left(\lambda-\mathrm{i}\right)^1 & \left(\lambda+\mathrm{i}\right)^1, \\
	d_k\left(\lambda\right) &=& \lambda^3\left(\lambda^2+1\right)^2\left(\lambda^2-2\right) &=& \lambda^3 & \left(\lambda-\sqrt{2}\right)^1 & \left(\lambda+\sqrt{2}\right)^1 & \left(\lambda-\mathrm{i}\right)^2 & \left(\lambda+\mathrm{i}\right)^2
\end{eqnarray}`$

所以在$`\mathbb{C}`$上，矩阵的初等因子组是$`\lambda, \lambda-\mathrm{i}, \lambda+\mathrm{i}, \lambda^2, \lambda-\mathrm{i}, \lambda+\mathrm{i}, \lambda^3, \lambda-\sqrt{2}, \lambda+\sqrt{2}, \left(\lambda-\mathrm{i}\right)^2, \left(\lambda+\mathrm{i}\right)^2`$。

---

### 7.6 Jordan标准型
#### 7.6.1
**已知矩阵的下列初等因子组，写出Jordan标准型：**
##### (1)
$`\lambda, \lambda^2, \left(\lambda-1\right)^2, \left(\lambda-1\right)^2`$；
$`\boldsymbol{J} = \left(\begin{matrix}
	0 \\
	& 0 & 1 \\
	& 0 & 0 \\
	& & & 1 & 1 \\
	& & & 0 & 1 \\
	& & & & & 1 & 1 \\
	& & & & & 0 & 1
\end{matrix}\right)`$

  
##### (2)
$`\left(\lambda+1\right)^2, \lambda-2, \left(\lambda-2\right)^3`$
$`\boldsymbol{J} = \left(\begin{matrix}
	-1 & 1 \\
	0 & -1 \\
	& & 2 \\
	& & & 2 & 1 & 0 \\
	& & & 0 & 2 & 1 \\
	& & & 0 & 0 & 2
\end{matrix}\right)`$

  
##### (3)
$`\left(\lambda-\sqrt{2}\right)^2, \lambda-1, \left(\lambda-1\right)^3, \left(\lambda-1\right)^3`$
$`\boldsymbol{J} = \left(\begin{matrix}
	\sqrt{2} & 1 \\
	0 & \sqrt{2} \\
	& & 1 \\
	& & & 1 & 1 & 0 \\
	& & & 0 & 1 & 1 \\
	& & & 0 & 0 & 1 \\
	& & & & & & 1 & 1 & 0 \\
	& & & & & & 0 & 1 & 1 \\
	& & & & & & 0 & 0 & 1 \\
\end{matrix}\right)`$

---

#### 7.6.4
**设$`n`$阶矩阵$`\boldsymbol{A}`$适合$`\boldsymbol{A}^2 = \boldsymbol{O}`$且$`\boldsymbol{A}`$的秩等于$`r`$，试求$`\boldsymbol{A}`$的Jordan标准型。**

1. $`r=0`$时，$`\boldsymbol{A} = \boldsymbol{A}^2 = \boldsymbol{O}_n`$，则$`\boldsymbol{J} = \boldsymbol{O}_n`$。
2. $`r \gt 0`$时，有$`\boldsymbol{A} \neq \boldsymbol{O}`$。
   
   又$`\boldsymbol{A}^2 = \boldsymbol{O}`$，所以$`m_{\boldsymbol{A}}\left(\lambda\right) = \lambda^2`$，所以$`\boldsymbol{A}`$的最后一个不变因子是$`\lambda^2`$。

   根据不变因子间的整除关系，$`\boldsymbol{A}`$的不变因子组是$`\overbrace{1, \cdots, 1}^{a_0\text{个}}, \overbrace{\lambda, \cdots, \lambda}^{a_1\text{个}}, \overbrace{\lambda^2, \cdots, \lambda^2}^{a_2\text{个}}`$，其中$`\left\{\begin{eqnarray}
		a_0 + a_1 + a_2 &=& n, \\
		a_0 &=& r, \\
		a_1 + 2a_2 &=& n
   \end{eqnarray}\right.`$

   所以有$`\left\{\begin{eqnarray}
		a_0 &=& r, \\
		a_1 &=& n - 2r, \\
		a_2 &=& r
   \end{eqnarray}\right.`$

   分解为准素因子，可得$`\boldsymbol{A}`$的初等因子组是$`\overbrace{\lambda, \cdots, \lambda}^{a_1\text{个}}, \overbrace{\lambda^2, \cdots, \lambda^2}^{a_2\text{个}}`$。

   所以$`\boldsymbol{J} = \mathrm{diag}\left\{\overbrace{\boldsymbol{J}_1\left(0\right), \cdots, \boldsymbol{J}_1\left(0\right)}^{a_1\text{个}}, \overbrace{\boldsymbol{J}_2\left(0\right), \cdots, \boldsymbol{J}_2\left(0\right)}^{a_2\text{个}}\right\} = \mathrm{diag}\left\{\overbrace{0, \cdots, 0}^{n-2r\text{个}}, \overbrace{\boldsymbol{J}_2\left(0\right), \cdots, \boldsymbol{J}_2\left(0\right)}^{r\text{个}}\right\}`$。


---

#### 7.6.6
**设$`n\left(n \gt 1\right)`$阶矩阵$`\boldsymbol{A}`$的秩为$`1`$，试求$`\boldsymbol{A}`$的Jordan标准型。**

不满秩的矩阵必有零特征值。

设$`\boldsymbol{A}`$的Jordan标准型
$`\boldsymbol{J} = \mathrm{diag}\left\{\boldsymbol{J}_{n_1}\left(0\right), \cdots, \boldsymbol{J}_{n_k}\left(0\right), \boldsymbol{J}_{s_1}\left(\lambda_1\right), \cdots, \boldsymbol{J}_{s_m}\left(\lambda_m\right)\right\}`$，其中，

$`\begin{eqnarray}
	\mathrm{rank}\boldsymbol{J}_{n_i}\left(0\right) &=& \mathrm{tr}\left(\begin{matrix}
		0 & 1 \\
		& 0 & 1 \\
		& & \ddots & \ddots \\
		& & & 0 & 1 \\
		& & & & 0
	\end{matrix}\right) &=&& n_i - 1, \\
	\mathrm{rank}\boldsymbol{J}_{s_j}\left(\lambda_j\right) &=& \mathrm{tr}\left(\begin{matrix}
		\lambda_j & 1 \\
		& \lambda_j & 1 \\
		& & \ddots & \ddots \\
		& & & \lambda_j & 1 \\
		& & & & \lambda_j
	\end{matrix}\right) &=&& s_j, \\
	\mathrm{rank}\boldsymbol{J} &=& \sum_{i=1}^k\left.\mathrm{rank}\boldsymbol{J}_{n_i}\left(0\right)\right. + \sum_{j=1}^m\left.\mathrm{rank}\boldsymbol{J}_{s_j}\left(\lambda_j\right)\right. &=&& \sum_{i=1}^k\left(n_i - 1\right) + \sum_{j=1}^m\left.s_j\right.
\end{eqnarray}`$

因为秩是相似不变量，所以$`\mathrm{rank}\boldsymbol{J} = \mathrm{rank}\boldsymbol{A} = 1`$。

因为$`n_i, s_j \gt 0`$，所以只有两种情况：

1. $`n_i = 0\left(i=1,\cdots,k\right), m=1, s_1=1`$。此时，$`\boldsymbol{J} = \mathrm{diag}\left\{0, \cdots, 0, \lambda_1\right\}`$。由于迹是相似不变量，所以$`\lambda_1 = \mathrm{tr}\boldsymbol{J} = \mathrm{tr}\boldsymbol{A}`$，$`\boldsymbol{J} = \mathrm{diag}\left\{0, \cdots, 0, \mathrm{tr}\boldsymbol{A}\right\}`$。
2. 有一个$`n_{i_0}=2, n_i=1\left(i\neq i_0\right), m=0`$。此时，$`\boldsymbol{J} = \mathrm{diag}\left\{0, \cdots, 0, \boldsymbol{J}_2\left(0\right), 0, \cdots, 0\right\} `$。


---

#### 7.6.8
**设$`n`$阶矩阵$`\boldsymbol{A}`$的极小多项式的次数等于$`n`$，求证：$`\boldsymbol{A}`$的Jordan标准型中各个Jordan块的主对角元素彼此不同。**

$`\boldsymbol{A}`$的极小多项式等于$`\boldsymbol{A}`$的最后一个不变因子$`d_k\left(\lambda\right)`$，所以$`\deg{d_k\left(\lambda\right)} = \deg{m_{\boldsymbol{A}}\left(\lambda\right)} = n`$。

特征多项式是所有不变因子的积，即$`f_{\boldsymbol{A}}\left(\lambda\right) = d_1\left(\lambda\right)d_2\left(\lambda\right)\cdots d_k\left(\lambda\right)`$，所以$`\deg{f_{\boldsymbol{A}}\left(\lambda\right)} = \deg{d_1\left(\lambda\right)} + \deg{d_2\left(\lambda\right)} + \cdots + \deg{d_k\left(\lambda\right)}`$。

又因为$`\deg{f_{\boldsymbol{A}}\left(\lambda\right)} = n`$，所以$`d_1\left(\lambda\right) = d_2\left(\lambda\right) = \cdots = d_{k-1}\left(\lambda\right) = 1, d_k\left(\lambda\right) = m_{\boldsymbol{A}}\left(\lambda\right) = f_{\boldsymbol{A}}\left(\lambda\right)`$。

对不变因子组分解，得到初等因子组。实际上分解过程中只会得到$`d_k\left(\lambda\right)`$的准素因子组$`\left(\lambda-\lambda_1\right)^{r_1},\left(\lambda-\lambda_2\right)^{r_2},\cdots,\left(\lambda-\lambda_s\right)^{r_s}`$，其中$`\lambda_1,\lambda_2\cdots,\lambda_s`$各不相同。

所以$`\boldsymbol{A}`$的Jordan标准型是$`\mathrm{diag}\left\{\boldsymbol{J}_{r_1}\left(\lambda_1\right),\boldsymbol{J}_{r_2}\left(\lambda_2\right),\cdots,\boldsymbol{J}_{r_s}\left(\lambda_s\right)\right\}`$，其中各个Jordan块的主对角元素彼此不同。



---

#### 7.6.9
**设$`\boldsymbol{A}`$是$`n`$阶复矩阵且存在正整数$`k`$使得$`\boldsymbol{A}^k = \boldsymbol{I}_n`$，求证：$`\boldsymbol{A}`$相似于对角阵。**

因为$`\boldsymbol{A}`$满足$`\boldsymbol{A}^k = \boldsymbol{I}_n`$，所以$`\boldsymbol{A}`$零化多项式$`\lambda^k-1`$。

所以$`m_{\boldsymbol{A}}\left(\lambda\right)\mid \lambda^k-1`$。

因为$`\lambda^k-1`$无重根，所以$`m_{\boldsymbol{A}}\left(\lambda\right)`$无重根。

所以$`\boldsymbol{A}`$的Jordan标准型中只有一阶Jordan块，即$`\boldsymbol{A}`$的Jordan标准型是对角阵。

所以$`\boldsymbol{A}`$相似于对角阵。


---

#### 7.6.11
**设$`n`$阶矩阵$`\boldsymbol{A}`$的全体不同特征值为$`\lambda_1,\lambda_2,\cdots,\lambda_k`$，令$`g\left(\lambda\right) = \left(\lambda-\lambda_1\right)\left(\lambda-\lambda_2\right)\cdots\left(\lambda-\lambda_k\right)`$，求证：$`\boldsymbol{A}`$可对角化的充分必要条件是$`g\left(\boldsymbol{A}\right) = \boldsymbol{O}`$。**

* 充分性：
  $`g\left(\boldsymbol{A}\right)=\boldsymbol{O}`$即$`\boldsymbol{A}`$零化$`g\left(\lambda\right)`$。

  所以$`m_{\boldsymbol{A}}\left(\lambda\right)\mid g\left(\lambda\right)`$。

  因为$`g\left(\lambda\right)`$无重根，所以$`m_{\boldsymbol{A}}\left(\lambda\right)`$无重根。

  所以$`\boldsymbol{A}`$的Jordan标准型中只有一阶Jordan块，即$`\boldsymbol{A}`$的Jordan标准型是对角阵。

  所以$`\boldsymbol{A}`$可对角化。

  
* 必要性：
  $`\boldsymbol{A}`$可对角化，则存在可逆阵$`\boldsymbol{Q}`$和对角阵$`\boldsymbol{\Lambda}`$，使得$`\boldsymbol{A} = \boldsymbol{Q}^{-1}\boldsymbol{\Lambda}\boldsymbol{Q}`$。其中$`\boldsymbol{\Lambda} = \mathrm{diag}\left\{\lambda_1,\cdots,\lambda_1,\lambda_2,\cdots,\lambda_2,\cdots,\lambda_k,\cdots,\lambda_k\right\}`$。

  记$`k`$阶多项式$`g\left(\lambda\right)`$的展开是$`\sum_{i=0}^k\left.\alpha_i\lambda^i\right.`$，则  
  $`\begin{split}
	g\left(\boldsymbol{A}\right) &= g\left(\boldsymbol{Q}^{-1}\boldsymbol{\Lambda}\boldsymbol{Q}\right) \\
	&= \sum_{i=0}^k\left.\alpha_i\left(\boldsymbol{Q}^{-1}\boldsymbol{\Lambda}\boldsymbol{Q}\right)^i\right. \\
	&= \sum_{i=0}^k\left.\alpha_i\boldsymbol{Q}^{-1}\boldsymbol{\Lambda}^i\boldsymbol{Q}\right. \\
	&= \boldsymbol{Q}^{-1}\left(\sum_{i=0}^k\alpha_i\boldsymbol{\Lambda}^i\right)\boldsymbol{Q} \\
	&= \boldsymbol{Q}^{-1}g\left(\boldsymbol{\Lambda}\right)\boldsymbol{Q}
  \end{split}`$

  对任意分块对角矩阵$`\boldsymbol{D} = \mathrm{diag}\left\{\boldsymbol{D}_1,\boldsymbol{D}_2,\cdots,\boldsymbol{D}_r\right\}`$，有  
  $`\begin{split}
	g\left(\boldsymbol{D}\right) &= \sum_{i=0}^k\alpha_i\boldsymbol{D}^i \\
	&= \sum_{i=0}^k\alpha_i\mathrm{diag}\left\{\boldsymbol{D}_1^i,\boldsymbol{D}_2^i,\cdots,\boldsymbol{D}_r^i\right\} \\
	&= \sum_{i=0}^k\mathrm{diag}\left\{\alpha_i\boldsymbol{D}_1^i,\alpha_i\boldsymbol{D}_2^i,\cdots,\alpha_i\boldsymbol{D}_r^i\right\} \\
	&= \mathrm{diag}\left\{\sum_{i=0}^k\alpha_i\boldsymbol{D}_1^i,\sum_{i=0}^k\alpha_i\boldsymbol{D}_2^i,\cdots,\sum_{i=0}^k\alpha_i\boldsymbol{D}_r^i\right\} \\
	&= \mathrm{diag}\left\{g\left(\boldsymbol{D}_1\right),g\left(\boldsymbol{D}_2\right),\cdots,g\left(\boldsymbol{D}_r\right)\right\}
  \end{split}`$

  所以$`g\left(\boldsymbol{A}\right) = \boldsymbol{Q}^{-1}g\left(\boldsymbol{\Lambda}\right)\boldsymbol{Q} = \boldsymbol{Q}^{-1}\mathrm{diag}\left\{g\left(\lambda_1\right),\cdots,g\left(\lambda_1\right),g\left(\lambda_2\right),\cdots,g\left(\lambda_2\right),\cdots,g\left(\lambda_k\right),\cdots,g\left(\lambda_k\right)\right\}\boldsymbol{Q}`$。

  而对任意$`\lambda_i`$，有$`g\left(\lambda_i\right) = \left(\lambda_i-\lambda_1\right)\left(\lambda_i-\lambda_2\right)\cdots\left(\lambda_i-\lambda_i\right)\cdots\left(\lambda_i-\lambda_k\right) = 0`$。

  所以$`g\left(\boldsymbol{A}\right) = \boldsymbol{Q}^{-1}\mathrm{diag}\left\{0,\cdots,0\right\}\boldsymbol{Q} = \boldsymbol{O}`$。


---

#### 7.6.12
**设$`\boldsymbol{A}`$是$`n`$阶复矩阵，求证：$`\boldsymbol{A}`$相似于分块对角矩阵$`\mathrm{diag}\left\{\boldsymbol{B},\boldsymbol{C}\right\}`$，其中$`\boldsymbol{B}`$是幂零阵，$`\boldsymbol{C}`$是非异阵。**

记$`\boldsymbol{A}`$的非零特征值初等因子组为$`\left(\lambda-\lambda_1\right)^{r_1},\left(\lambda-\lambda_2\right)^{r_2},\cdots,\left(\lambda-\lambda_k\right)^{r_k}`$，零特征值初等因子组为$`\lambda^{s_1},\lambda^{s_2},\cdots,\lambda^{s_l}`$。

则$`\boldsymbol{A}`$的Jordan标准型$`\boldsymbol{J} = \mathrm{diag}\left\{\boldsymbol{J}_{s_1}\left(0\right),\boldsymbol{J}_{s_2}\left(0\right),\cdots,\boldsymbol{J}_{s_l}\left(0\right);\boldsymbol{J}_{r_1}\left(\lambda_1\right),\boldsymbol{J}_{r_2}\left(\lambda_2\right),\cdots,\boldsymbol{J}_{r_k}\left(\lambda_k\right)\right\}`$

令$`\boldsymbol{B} = \mathrm{diag}\left\{\boldsymbol{J}_{s_1}\left(0\right),\boldsymbol{J}_{s_2}\left(0\right),\cdots,\boldsymbol{J}_{s_l}\left(0\right)\right\},\boldsymbol{C} = \mathrm{diag}\left\{\boldsymbol{J}_{r_1}\left(\lambda_1\right),\boldsymbol{J}_{r_2}\left(\lambda_2\right),\cdots,\boldsymbol{J}_{r_k}\left(\lambda_k\right)\right\}`$。

* $`\boldsymbol{B}`$只有对角线以上的部分非零，$`\boldsymbol{B}^{s_1+s_2+\cdots+s_l}=\boldsymbol{O}`$，至多是$`s_1+s_2+\cdots+s_l`$次幂零阵；
* $`\boldsymbol{C}`$是上三角矩阵，且对角线全非零，$`\mathrm{rank}\boldsymbol{C} = r_1+r_2+\cdots+r_k`$，是满轶矩阵。所以$`\boldsymbol{C}`$非异。

因为$`\boldsymbol{A}`$相似于$`\boldsymbol{J}`$，所以$`\boldsymbol{A}`$相似于$`\mathrm{diag}\left\{\boldsymbol{B},\boldsymbol{C}\right\}`$。



---

### 7.7 Jordan标准型的进一步讨论和应用
#### 7.7.2
**求下列矩阵的$`k\left(k>1\right)`$次幂：**
##### (1)
$`\left(\begin{matrix}
	3 & -4 & 0 & 2 \\
	4 & -5 & -2 & 4 \\
	0 & 0 & 3 & -2 \\
	0 & 0 & 2 & -1
\end{matrix}\right)`$；

记矩阵为$`\boldsymbol{A}`$，按最后一行展开计算$`\boldsymbol{A}`$的特征多项式：

$`\begin{split}
	\left|\lambda\boldsymbol{I}-\boldsymbol{A}\right| 
	&= \left|\begin{matrix}
		\lambda-3 & 4 & 0 & -2 \\
		-4 & \lambda+5 & 2 & -4 \\
		0 & 0 & \lambda-3 & 2 \\
		0 & 0 & -2 & \lambda+1
	\end{matrix}\right| \\
	&= 2\times 2\left|\begin{matrix}
		\lambda-3 & 4 \\
		-4 & \lambda+5
	\end{matrix}\right| + \left(\lambda+1\right)\left(\lambda-3\right)\left|\begin{matrix}
		\lambda-3 & 4 \\
		-4 & \lambda+5
	\end{matrix}\right| \\
	&= \left(\lambda^2-2\lambda+1\right)\left(\lambda^2+2\lambda+1\right) \\
	&= \left(\lambda-1\right)^2\left(\lambda+1\right)^2
\end{split}`$

* 特征值$`1`$的几何重数  
  $`\begin{split}
  	\dim{V_1} &= \dim{\ker{\left(\boldsymbol{I}-\boldsymbol{A}\right)}} \\
  	&= 4 - \mathrm{rank}\left(\boldsymbol{I}-\boldsymbol{A}\right) \\
  	&= 4 - \mathrm{rank}\left(\begin{matrix}
  		-2 & 4 & 0 & -2 \\
  		-4 & 6 & 2 & -4 \\
  		0 & 0 & -2 & 2 \\
  		0 & 0 & -2 & 2
  	\end{matrix}\right) \\
  	&= 1,\end{split}`$
  而$`1`$的代数重数是$`2`$，所以$`1`$对应$`1`$个$`2`$阶Jordan块。  
  $`\begin{split}
  	\ker{\left(\boldsymbol{I}-\boldsymbol{A}\right)} 
	&= \ker{\left(\begin{matrix}
  		-2 & 4 & 0 & -2 \\
  		-4 & 6 & 2 & -4 \\
  		0 & 0 & -2 & 2 \\
  		0 & 0 & -2 & 2
  	\end{matrix}\right)} \\
  	&= \ker{\left(\begin{matrix}
  		2 & -2 & 0 & 0 \\
  		-4 & 6 & 0 & -2 \\
  		0 & 0 & -2 & 2 \\
  		0 & 0 & 0 & 0
  	\end{matrix}\right)} \\
	&= \mathrm{span}\left(1,1,1,1\right)
  \end{split}`$。
* 特征值$`-1`$的几何重数  
  $`\begin{split}
  	\dim{V_{-1}} &= \dim{\ker{\left(-\boldsymbol{I}-\boldsymbol{A}\right)}} \\
  	&= 4 - \mathrm{rank}\left(-\boldsymbol{I}-\boldsymbol{A}\right) \\
  	&= 4 - \mathrm{rank}\left(\begin{matrix}
  		-4 & 4 & 0 & -2 \\
  		-4 & 4 & 2 & -4 \\
  		0 & 0 & -4 & 2 \\
  		0 & 0 & -2 & 0
  	\end{matrix}\right) \\
  	&= 1,\end{split}`$
  而$`-1`$的代数重数是$`2`$，所以$`-1`$对应$`1`$个$`2`$阶Jordan块。  
  $`\begin{split}
  	\ker{\left(-\boldsymbol{I}-\boldsymbol{A}\right)} 
	&= \ker{\left(\begin{matrix}
  		-4 & 4 & 0 & -2 \\
  		-4 & 4 & 2 & -4 \\
  		0 & 0 & -4 & 2 \\
  		0 & 0 & -2 & 0
  	\end{matrix}\right)} \\
  	&= \ker{\left(\begin{matrix}
  		-4 & 4 & 0 & 0 \\
  		0 & 0 & 0 & 0 \\
  		0 & 0 & 0 & 2 \\
  		0 & 0 & -2 & 0
  	\end{matrix}\right)} \\
	&= \mathrm{span}\left(1,1,0,0\right)
  \end{split}`$。

所以$`\boldsymbol{A}`$的Jordan标准型$`\boldsymbol{J} = \left(\begin{matrix}
	1 & 1 && \\
	0 & 1 && \\
	&& -1 & 1 \\
	&& 0 & -1
\end{matrix}\right)`$。即存在可逆阵$`\boldsymbol{P}`$，使得$`\boldsymbol{A}\boldsymbol{P} = \boldsymbol{P}\boldsymbol{J}`$。

设$`\boldsymbol{P} = \left(\boldsymbol{p}_1,\boldsymbol{p}_2,\boldsymbol{p}_3,\boldsymbol{p}_4\right)`$，则有$`\left(\boldsymbol{A}\boldsymbol{p}_1,\boldsymbol{A}\boldsymbol{p}_2,\boldsymbol{A}\boldsymbol{p}_3,\boldsymbol{A}\boldsymbol{p}_4\right) = \left(\boldsymbol{p}_1,\boldsymbol{p}_1+\boldsymbol{p}_2,-\boldsymbol{p}_3,\boldsymbol{p}_3-\boldsymbol{p}_4\right)`$。

所以$`\left\{\begin{array}{rl}
	\boldsymbol{A}\boldsymbol{p}_1 &= \boldsymbol{p}_1, \\
	\left(\boldsymbol{A}-\boldsymbol{I}\right)\boldsymbol{p}_2 &= \boldsymbol{p}_1, \\
	\boldsymbol{A}\boldsymbol{p}_3 &= -\boldsymbol{p}_3, \\
	\left(\boldsymbol{A}+\boldsymbol{I}\right)\boldsymbol{p}_4 &= \boldsymbol{p}_3.
\end{array}\right.`$

取$`\left\{\begin{array}{rl}
	\boldsymbol{p}_1 &= \left(1,1,1,1\right), \\
	\boldsymbol{p}_3 &= \left(1,1,0,0\right).
\end{array}\right.`$

则有$`\left\{\begin{array}{rl}
	\boldsymbol{p}_2 &= \left(\frac{1}{2},0,\frac{1}{2},0\right), \\
	\boldsymbol{p}_4 &= \left(\frac{1}{4},0,0,0\right).
\end{array}\right.`$

所以$`\boldsymbol{P} = \left(\begin{matrix}
	1 & \frac{1}{2} & 1 & \frac{1}{4} \\
	1 & 0 & 1 & 0 \\
	1 & \frac{1}{2} & 0 & 0 \\
	1 & 0 & 0 & 0
\end{matrix}\right)`$。

又因为$`\boldsymbol{J}^k = \left(\begin{matrix}
	1 & \left(\begin{matrix}k\\1\end{matrix}\right) && \\
	0 & 1 && \\
	&& \left(-1\right)^k & \left(\begin{matrix}k\\1\end{matrix}\right)\left(-1\right)^{k-1} \\
	&& 0 & \left(-1\right)^k
\end{matrix}\right) = \left(\begin{matrix}
	1 & k && \\
	0 & 1 && \\
	&& \left(-1\right) & \left(-1\right)^{k-1}k \\
	&& 0 & \left(-1\right)^k
\end{matrix}\right)`$，

所以$`\begin{split}
	\boldsymbol{A}^k &= \left(\boldsymbol{P}\boldsymbol{J}\boldsymbol{P}^{-1}\right)^k \\
	&= \boldsymbol{P}\boldsymbol{J}^k\boldsymbol{P}^{-1} \\
	&= \left(\begin{matrix}
		\left(-1\right)^k\left(-4k+1\right) & \left(-1\right)^k 4k & \left(-1\right)^k\left(4k-1\right)+2k+1 & -\left(-1\right)^k 4k-2k \\
		-\left(-1\right)^k 4k & \left(-1\right)^k\left(4k+1\right) & \left(-1\right)^k 4k+2k & -\left(-1\right)^k\left(4k+1\right)-2k+1 \\
		0 & 0 & 2k+1 & -2k \\
		0 & 0 & 2k & -2k+1
	\end{matrix}\right)
\end{split}`$



##### (2)
$`\left(\begin{matrix}
	4 & -1 & 1 & -7 \\
	9 & -2 & -7 & -1 \\
	0 & 0 & 5 & -8 \\
	0 & 0 & 2 & -3
\end{matrix}\right)`$。

记矩阵为$`\boldsymbol{A}`$，计算$`\boldsymbol{A}`$的法式：

$`\begin{split}
	\lambda\boldsymbol{I}-\boldsymbol{A} 
	=& \left(\begin{matrix}
		\lambda-4 & 1 & -1 & 7 \\
		-9 & \lambda+2 & 7 & 1 \\
		0 & 0 & \lambda-5 & 8 \\
		0 & 0 & -2 & \lambda+3
	\end{matrix}\right) \\
	\rightarrow& \left(\begin{matrix}
		1 & \lambda-4 & -1 & 7 \\
		\lambda+2 & -9 & 7 & 1 \\
		0 & 0 & \lambda-5 & 8 \\
		0 & 0 & -2 & \lambda+3
	\end{matrix}\right) \\
	\rightarrow& \left(\begin{matrix}
		1 & 0 & 0 & 0 \\
		0 & -\left(\lambda-1\right)^2 & \lambda+9 & -7\lambda-13 \\
		0 & 0 & \lambda-5 & 8 \\
		0 & 0 & -2 & \lambda+3
	\end{matrix}\right) \\
	\rightarrow& \left(\begin{matrix}
		1 & 0 & 0 & 0 \\
		0 & -2 & 0 & \lambda+3 \\
		0 & \lambda-5 & 0 & 8 \\
		0 & \lambda+9 & -\left(\lambda-1\right)^2 & -7\lambda-13
	\end{matrix}\right) \\
	\rightarrow& \left(\begin{matrix}
		1 & 0 & 0 & 0 \\
		0 & -2 & 0 & 0 \\
		0 & 0 & 0 & \frac{\left(\lambda-1\right)^2}{2} \\
		0 & 0 & -\left(\lambda-1\right)^2 & \frac{\left(\lambda-1\right)^2}{2}
	\end{matrix}\right) \\
	\rightarrow& \left(\begin{matrix}
		1 & 0 & 0 & 0 \\
		0 & 1 & 0 & 0 \\
		0 & 0 & \left(\lambda-1\right)^2 & 0 \\
		0 & 0 & 0 & \left(\lambda-1\right)^2
	\end{matrix}\right) \\
\end{split}`$

$`\boldsymbol{A}`$的不变因子组是$`\left(\lambda-1\right)^2,\left(\lambda-1\right)^2`$，所以$`\boldsymbol{A}`$的初等因子组也是$`\left(\lambda-1\right)^2,\left(\lambda-1\right)^2`$。

所以$`\boldsymbol{A}`$的Jordan标准型$`\boldsymbol{J} = \left(\begin{matrix}
	1 & 1 && \\
	0 & 1 && \\
	&& 1 & 1 \\
	&& 0 & 1
\end{matrix}\right)`$。即存在可逆阵$`\boldsymbol{P}`$，使得$`\boldsymbol{A}\boldsymbol{P} = \boldsymbol{P}\boldsymbol{J}`$。

设$`\boldsymbol{P} = \left(\boldsymbol{p}_1,\boldsymbol{p}_2,\boldsymbol{p}_3,\boldsymbol{p}_4\right)`$，则有$`\left(\boldsymbol{A}\boldsymbol{p}_1,\boldsymbol{A}\boldsymbol{p}_2,\boldsymbol{A}\boldsymbol{p}_3,\boldsymbol{A}\boldsymbol{p}_4\right) = \left(\boldsymbol{p}_1,\boldsymbol{p}_1+\boldsymbol{p}_2,\boldsymbol{p}_3,\boldsymbol{p}_3+\boldsymbol{p}_4\right)`$。

所以$`\left\{\begin{array}{rl}
	\boldsymbol{A}\boldsymbol{p}_1 &= \boldsymbol{p}_1, \\
	\left(\boldsymbol{A}-\boldsymbol{I}\right)\boldsymbol{p}_2 &= \boldsymbol{p}_1, \\
	\boldsymbol{A}\boldsymbol{p}_3 &= \boldsymbol{p}_3, \\
	\left(\boldsymbol{A}-\boldsymbol{I}\right)\boldsymbol{p}_4 &= \boldsymbol{p}_3.
\end{array}\right.`$

求解$`\boldsymbol{A}`$的特征方程，得到$`\left\{\begin{array}{rl}
	\boldsymbol{p}_1 &= \left(\frac{1}{3},1,0,0\right), \\
	\boldsymbol{p}_3 &= \left(\frac{5}{3},0,2,1\right).
\end{array}\right.`$

则有$`\left\{\begin{array}{rl}
	\boldsymbol{p}_2 &= \left(\frac{1}{9},0,0,0\right), \\
	\boldsymbol{p}_4 &= \left(\frac{7}{18},0,\frac{1}{2},0\right).
\end{array}\right.`$

所以$`\boldsymbol{P} = \left(\begin{matrix}
	\frac{1}{3} & \frac{1}{9} & \frac{5}{3} & \frac{7}{18} \\
	1 & 0 & 0 & 0 \\
	0 & 0 & 2 & \frac{1}{2} \\
	0 & 0 & 1 & 0
\end{matrix}\right)`$。

又因为$`\boldsymbol{J}^k = \left(\begin{matrix}
	1 & k && \\
	0 & 1 && \\
	&& 1 & k \\
	&& 0 & 1
\end{matrix}\right)`$，

所以  
$`\begin{split}
	\boldsymbol{A}^k &= \left(\boldsymbol{P}\boldsymbol{J}\boldsymbol{P}^{-1}\right)^k \\
	&= \boldsymbol{P}\boldsymbol{J}^k\boldsymbol{P}^{-1} \\
	&= \left(\begin{matrix}
		3k+1 & -k & k & -7k \\
		9k & -3k+1 & -7k & -k \\
		0 & 0 & 4k+1 & -8k \\
		0 & 0 & 2k & -4k+1
	\end{matrix}\right).
\end{split}`$



---

## 9 内积空间
### 9.1 内积空间的概念
#### 9.1.8
**证明：下列$`\left(\boldsymbol{A},\boldsymbol{B}\right)`$分别定义了$`n`$阶实矩阵空间和$`n`$阶复矩阵空间上的内积（称为Frobenius内积）：**
##### (1)
**设$`V`$为$`n`$阶实矩阵空间，对任意的$`n`$阶实矩阵$`\boldsymbol{A} = \left(a_{ij}\right),\boldsymbol{B} = \left(b_{ij}\right)`$，定义$`\left(\boldsymbol{A},\boldsymbol{B}\right) = \mathrm{tr}\left(\boldsymbol{A}\boldsymbol{B}^{\mathrm{T}}\right) = \sum_{i=1}^n\sum_{j=1}^n a_{ij}b_{ij}`$；**

⏳

##### (2)
**设$`V`$为$`n`$阶复矩阵空间，对任意的$`n`$阶实矩阵$`\boldsymbol{A} = \left(a_{ij}\right),\boldsymbol{B} = \left(b_{ij}\right)`$，定义$`\left(\boldsymbol{A},\boldsymbol{B}\right) = \mathrm{tr}\left(\boldsymbol{A}\overline{\boldsymbol{B}}^{\mathrm{T}}\right) = \sum_{i=1}^n\sum_{j=1}^n a_{ij}\overline{b_{ij}}`$。**

$`\begin{array}{rrcl}\left(\cdot,\cdot\right):& M_{n}\left(\mathbb{C}\right)^2 &\rightarrow & \mathbb{C} \\ & \boldsymbol{A},\boldsymbol{B} & \mapsto & \mathrm{tr}\left(\boldsymbol{A}\overline{\boldsymbol{B}}^{\mathrm{T}}\right) = \sum_{i=1}^n\sum_{j=1}^n a_{ij}\overline{b_{ij}}\end{array}`$  
且$`\left(\cdot,\cdot\right)`$满足：  
1. $`\left(\boldsymbol{B},\boldsymbol{A}\right) = \sum_{i=1}^n\sum_{j=1}^n b_{ij}\overline{a_{ij}}`$。  
   因为共轭满足
   * $`b_{ij}\overline{a_{ij}} = \overline{\overline{b_{ij}}a_{ij}}`$，
   * $`\sum_{i=1}^n \overline{c_i} = \overline{\sum_{i=1}^n c_i}`$，
   
   所以
   $`\begin{split}
   \sum_{i=1}^n\sum_{j=1}^n b_{ij}\overline{a_{ij}} &= \sum_{i=1}^n\sum_{j=1}^n \overline{\overline{b_{ij}}a_{ij}} \\ &= \sum_{i=1}^n\overline{\sum_{j=1}^n \overline{b_{ij}}a_{ij}} \\ &= \overline{\sum_{i=1}^n\sum_{j=1}^n a_{ij}\overline{b_{ij}}}\end{split}`$  
   根据定义，有$`\overline{\sum_{i=1}^n\sum_{j=1}^n a_{ij}\overline{b_{ij}}} = \overline{\left(\boldsymbol{A},\boldsymbol{B}\right)}`$。  
   所以$`\left(\boldsymbol{B},\boldsymbol{A}\right) = \overline{\left(\boldsymbol{A},\boldsymbol{B}\right)}`$。

2. $``$    
   $`\begin{split}\left(\boldsymbol{A}+\boldsymbol{B},\boldsymbol{C}\right) &= \sum_{i=1}^n\sum_{j=1}^n \left(\boldsymbol{A}+\boldsymbol{B}\right)_{ij}\overline{c_{ij}} \\ &= \sum_{i=1}^n\sum_{j=1}^n \left(a_{ij}+b_{ij}\right)\overline{c_{ij}} \\ &= \sum_{i=1}^n\sum_{j=1}^n \left(a_{ij}\overline{c_{ij}} + b_{ij}\overline{c_{ij}}\right) \\ &= \sum_{i=1}^n\sum_{j=1}^n a_{ij}\overline{c_{ij}} + \sum_{i=1}^n\sum_{j=1}^n b_{ij}\overline{c_{ij}}\end{split}`$  
   根据定义，有$`\sum_{i=1}^n\sum_{j=1}^n a_{ij}\overline{c_{ij}} = \left(\boldsymbol{A},\boldsymbol{C}\right),\sum_{i=1}^n\sum_{j=1}^n b_{ij}\overline{c_{ij}} = \left(\boldsymbol{B},\boldsymbol{C}\right)`$。  
   所以$`\left(\boldsymbol{A}+\boldsymbol{B},\boldsymbol{C}\right) = \left(\boldsymbol{A},\boldsymbol{C}\right) + \left(\boldsymbol{B},\boldsymbol{C}\right)`$。

3. $``$   
   $`\begin{split}\left(d\boldsymbol{A},\boldsymbol{B}\right) &= \sum_{i=1}^n\sum_{j=1}^n \left(d\boldsymbol{A}\right)_{ij}\overline{b_{ij}} \\ &= \sum_{i=1}^n\sum_{j=1}^n d a_{ij}\overline{b_{ij}} \\ &= d\sum_{i=1}^n\sum_{j=1}^n a_{ij}\overline{b_{ij}} \\ &= d\left(\boldsymbol{A},\boldsymbol{B}\right)\end{split}`$

4. $`\left(\boldsymbol{A},\boldsymbol{A}\right) = \sum_{i=1}^n\sum_{j=1}^n a_{ij}\overline{a_{ij}}`$。  
   因为共轭满足$`a_{ij}\overline{a_{ij}} = \left|a_{ij}\right|^2 \ge 0`$，所以$`\sum_{i=1}^n\sum_{j=1}^n a_{ij}\overline{a_{ij}} = \sum_{i=1}^n\sum_{j=1}^n \left|a_{ij}\right|^2 \ge 0`$。且由于$`\sum_{i=1}^n\sum_{j=1}^n \left|a_{ij}\right|^2`$表示$`\boldsymbol{A}`$中所有元素的模平方和，所以$`\sum_{i=1}^n\sum_{j=1}^n \left|a_{ij}\right|^2 = 0`$当且仅当$`a_{ij}=0,\left(i,j=1,2,\cdots,n\right)`$，即$`\boldsymbol{A} = \boldsymbol{O}`$。  
   所以$`\left(\boldsymbol{A},\boldsymbol{A}\right) \ge 0, \left(\boldsymbol{A},\boldsymbol{A}\right) = 0 \Leftrightarrow\boldsymbol{A} = \boldsymbol{O}`$。

所以$`\left(\cdot,\cdot\right)`$是$`M_{n}\left(\mathbb{C}\right)`$上的内积。

---

### 9.2 内积的表示和正交基
#### 9.2.2
**设$`\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n`$为内积空间$`V`$的一组标准正交基，求证：对任意的$`\boldsymbol{\alpha},\boldsymbol{\beta}\in V`$，有$`\left(\boldsymbol{\alpha},\boldsymbol{\beta}\right) = \left(\boldsymbol{\alpha},\boldsymbol{e}_1\right)\overline{\left(\boldsymbol{\beta},\boldsymbol{e}_1\right)} + \left(\boldsymbol{\alpha},\boldsymbol{e}_2\right)\overline{\left(\boldsymbol{\beta},\boldsymbol{e}_2\right)} + \cdots + \left(\boldsymbol{\alpha},\boldsymbol{e}_n\right)\overline{\left(\boldsymbol{\beta},\boldsymbol{e}_n\right)}`$。**

按$`\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n`$分解$`\boldsymbol{\alpha}`$和$`\boldsymbol{\beta}`$，有  
$`\begin{eqnarray}
	\boldsymbol{\alpha} &= \left(\boldsymbol{\alpha},\boldsymbol{e}_1\right)\boldsymbol{e}_1 + \left(\boldsymbol{\alpha},\boldsymbol{e}_2\right)\boldsymbol{e}_2 + \cdots + \left(\boldsymbol{\alpha},\boldsymbol{e}_n\right)\boldsymbol{e}_n \\
	\boldsymbol{\beta} &= \left(\boldsymbol{\beta},\boldsymbol{e}_1\right)\boldsymbol{e}_1 + \left(\boldsymbol{\beta},\boldsymbol{e}_2\right)\boldsymbol{e}_2 + \cdots + \left(\boldsymbol{\beta},\boldsymbol{e}_n\right)\boldsymbol{e}_n
\end{eqnarray}`$   
因为内积满足$`\left(\boldsymbol{\alpha}_1+\boldsymbol{\alpha}_2,\boldsymbol{\beta}\right) = \left(\boldsymbol{\alpha}_1,\boldsymbol{\beta}\right) + \left(\boldsymbol{\alpha}_2,\boldsymbol{\beta}\right)`$和$`\left(\boldsymbol{\alpha},\boldsymbol{\beta}\right) = \overline{\left(\boldsymbol{\beta},\boldsymbol{\alpha}\right)}`$，所以  
$`\begin{split}
	\left(\boldsymbol{\alpha},\boldsymbol{\beta}_1+\boldsymbol{\beta}_2\right) 
	&= \overline{\left(\boldsymbol{\beta}_1+\boldsymbol{\beta}_2,\boldsymbol{\alpha}\right)} \\
	&= \overline{\left(\boldsymbol{\beta}_1,\boldsymbol{\alpha}\right) + \left(\boldsymbol{\beta}_2,\boldsymbol{\alpha}\right)} \\
	&= \overline{\left(\boldsymbol{\beta}_1,\boldsymbol{\alpha}\right)} + \overline{\left(\boldsymbol{\beta}_2,\boldsymbol{\alpha}\right)} \\
	&= \left(\boldsymbol{\alpha},\boldsymbol{\beta}_1\right) + \left(\boldsymbol{\alpha},\boldsymbol{\beta}_2\right)
\end{split}`$  
因为内积满足$`\left(c\boldsymbol{\alpha},\boldsymbol{\beta}\right) = c\left(\boldsymbol{\alpha},\boldsymbol{\beta}\right)`$和$`\left(\boldsymbol{\alpha},\boldsymbol{\beta}\right) = \overline{\left(\boldsymbol{\beta},\boldsymbol{\alpha}\right)}`$，所以  
$`\begin{split}
	\left(\boldsymbol{\alpha},c\boldsymbol{\beta}\right) 
	&= \overline{\left(c\boldsymbol{\beta},\boldsymbol{\alpha}\right)} \\
	&= \overline{c\left(\boldsymbol{\beta},\boldsymbol{\alpha}\right)} \\
	&= \overline{c}\overline{\left(\boldsymbol{\beta},\boldsymbol{\alpha}\right)} \\
	&= \overline{c}\left(\boldsymbol{\alpha},\boldsymbol{\beta}\right)
\end{split}`$  
所以  
$`\begin{eqnarray}
	\left(\boldsymbol{\alpha},\boldsymbol{\beta}\right) 
	&=& \left(\boldsymbol{\alpha},\left(\boldsymbol{\beta},\boldsymbol{e}_1\right)\boldsymbol{e}_1 + \left(\boldsymbol{\beta},\boldsymbol{e}_2\right)\boldsymbol{e}_2 + \cdots + \left(\boldsymbol{\beta},\boldsymbol{e}_n\right)\boldsymbol{e}_n\right) \\
	&=& \left(\boldsymbol{\alpha},\left(\boldsymbol{\beta},\boldsymbol{e}_1\right)\boldsymbol{e}_1\right) + \left(\boldsymbol{\alpha},\left(\boldsymbol{\beta},\boldsymbol{e}_2\right)\boldsymbol{e}_2\right) + \cdots + \left(\boldsymbol{\alpha},\left(\boldsymbol{\beta},\boldsymbol{e}_n\right)\boldsymbol{e}_n\right) \\
	&=& \overline{\left(\boldsymbol{\beta},\boldsymbol{e}_1\right)}\left(\boldsymbol{\alpha},\boldsymbol{e}_1\right) + \overline{\left(\boldsymbol{\beta},\boldsymbol{e}_2\right)}\left(\boldsymbol{\alpha},\boldsymbol{e}_2\right) + \cdots + \overline{\left(\boldsymbol{\beta},\boldsymbol{e}_n\right)}\left(\boldsymbol{\alpha},\boldsymbol{e}_n\right) \\
	&=& \overline{\left(\boldsymbol{\beta},\boldsymbol{e}_1\right)}\left(\left(\boldsymbol{\alpha},\boldsymbol{e}_1\right)\boldsymbol{e}_1 + \left(\boldsymbol{\alpha},\boldsymbol{e}_2\right)\boldsymbol{e}_2 + \cdots + \left(\boldsymbol{\alpha},\boldsymbol{e}_n\right)\boldsymbol{e}_n,\boldsymbol{e}_1\right) \\
	&&+ \overline{\left(\boldsymbol{\beta},\boldsymbol{e}_2\right)}\left(\left(\boldsymbol{\alpha},\boldsymbol{e}_1\right)\boldsymbol{e}_1 + \left(\boldsymbol{\alpha},\boldsymbol{e}_2\right)\boldsymbol{e}_2 + \cdots + \left(\boldsymbol{\alpha},\boldsymbol{e}_n\right)\boldsymbol{e}_n,\boldsymbol{e}_2\right) \\
	&&+ \cdots \\
	&&+ \overline{\left(\boldsymbol{\beta},\boldsymbol{e}_n\right)}\left(\left(\boldsymbol{\alpha},\boldsymbol{e}_1\right)\boldsymbol{e}_1 + \left(\boldsymbol{\alpha},\boldsymbol{e}_2\right)\boldsymbol{e}_2 + \cdots + \left(\boldsymbol{\alpha},\boldsymbol{e}_n\right)\boldsymbol{e}_n,\boldsymbol{e}_n\right)
\end{eqnarray}`$  <!-- 为github显示拆分成两段，可能是因为一段时长度过大(Error: Unable to render expression.) -->
$`\begin{eqnarray}
	\qquad\;\; &=& \overline{\left(\boldsymbol{\beta},\boldsymbol{e}_1\right)}\left(\left(\left(\boldsymbol{\alpha},\boldsymbol{e}_1\right)\boldsymbol{e}_1,\boldsymbol{e}_1\right) + \left(\left(\boldsymbol{\alpha},\boldsymbol{e}_2\right)\boldsymbol{e}_2,\boldsymbol{e}_1\right) + \cdots + \left(\left(\boldsymbol{\alpha},\boldsymbol{e}_n\right)\boldsymbol{e}_n,\boldsymbol{e}_1\right)\right) \\
	&&+ \overline{\left(\boldsymbol{\beta},\boldsymbol{e}_2\right)}\left(\left(\left(\boldsymbol{\alpha},\boldsymbol{e}_1\right)\boldsymbol{e}_1,\boldsymbol{e}_2\right) + \left(\left(\boldsymbol{\alpha},\boldsymbol{e}_2\right)\boldsymbol{e}_2,\boldsymbol{e}_2\right) + \cdots + \left(\left(\boldsymbol{\alpha},\boldsymbol{e}_n\right)\boldsymbol{e}_n,\boldsymbol{e}_2\right)\right) \\
	&&+ \cdots \\
	&&+ \overline{\left(\boldsymbol{\beta},\boldsymbol{e}_n\right)}\left(\left(\left(\boldsymbol{\alpha},\boldsymbol{e}_1\right)\boldsymbol{e}_1,\boldsymbol{e}_n\right) + \left(\left(\boldsymbol{\alpha},\boldsymbol{e}_2\right)\boldsymbol{e}_2,\boldsymbol{e}_n\right) + \cdots + \left(\left(\boldsymbol{\alpha},\boldsymbol{e}_n\right)\boldsymbol{e}_n,\boldsymbol{e}_n\right)\right) \\
	&=& \overline{\left(\boldsymbol{\beta},\boldsymbol{e}_1\right)}\left(\left(\boldsymbol{\alpha},\boldsymbol{e}_1\right)\left(\boldsymbol{e}_1,\boldsymbol{e}_1\right) + \left(\boldsymbol{\alpha},\boldsymbol{e}_2\right)\left(\boldsymbol{e}_2,\boldsymbol{e}_1\right) + \cdots + \left(\boldsymbol{\alpha},\boldsymbol{e}_n\right)\left(\boldsymbol{e}_n,\boldsymbol{e}_1\right)\right) \\
	&&+ \overline{\left(\boldsymbol{\beta},\boldsymbol{e}_2\right)}\left(\left(\boldsymbol{\alpha},\boldsymbol{e}_1\right)\left(\boldsymbol{e}_1,\boldsymbol{e}_2\right) + \left(\boldsymbol{\alpha},\boldsymbol{e}_2\right)\left(\boldsymbol{e}_2,\boldsymbol{e}_2\right) + \cdots + \left(\boldsymbol{\alpha},\boldsymbol{e}_n\right)\left(\boldsymbol{e}_n,\boldsymbol{e}_2\right)\right) \\
	&&+ \cdots \\
	&&+ \overline{\left(\boldsymbol{\beta},\boldsymbol{e}_n\right)}\left(\left(\boldsymbol{\alpha},\boldsymbol{e}_1\right)\left(\boldsymbol{e}_1,\boldsymbol{e}_n\right) + \left(\boldsymbol{\alpha},\boldsymbol{e}_2\right)\left(\boldsymbol{e}_2,\boldsymbol{e}_n\right) + \cdots + \left(\boldsymbol{\alpha},\boldsymbol{e}_n\right)\left(\boldsymbol{e}_n,\boldsymbol{e}_n\right)\right)
\end{eqnarray}`$  
因为$`\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n`$是一组标准正交基，所以$`\left(\boldsymbol{e}_i,\boldsymbol{e}_j\right) = \begin{cases}
	1, &i=j, \\
	0, &i\ne j.
\end{cases}`$  
所以
$`\begin{eqnarray}
	\left(\boldsymbol{\alpha},\boldsymbol{\beta}\right) 
	&=& \overline{\left(\boldsymbol{\beta},\boldsymbol{e}_1\right)}\left(\left(\boldsymbol{\alpha},\boldsymbol{e}_1\right) + 0 + \cdots + 0\right) \\
	&&+ \overline{\left(\boldsymbol{\beta},\boldsymbol{e}_2\right)}\left(0 + \left(\boldsymbol{\alpha},\boldsymbol{e}_2\right) + \cdots + 0\right) \\
	&&+ \cdots \\
	&&+ \overline{\left(\boldsymbol{\beta},\boldsymbol{e}_n\right)}\left(0 + 0 + \cdots + \left(\boldsymbol{\alpha},\boldsymbol{e}_n\right)\right) \\
	&=& \left(\boldsymbol{\alpha},\boldsymbol{e}_1\right)\overline{\left(\boldsymbol{\beta},\boldsymbol{e}_1\right)} + \left(\boldsymbol{\alpha},\boldsymbol{e}_2\right)\overline{\left(\boldsymbol{\beta},\boldsymbol{e}_2\right)} + \cdots + \left(\boldsymbol{\alpha},\boldsymbol{e}_n\right)\overline{\left(\boldsymbol{\beta},\boldsymbol{e}_n\right)}
\end{eqnarray}`$


---

#### 9.2.3
**设$`V`$是内积空间，$`U`$是$`V`$的子空间，若$`U`$由向量$`\left\{\boldsymbol{u}_1,\boldsymbol{u}_2,\cdots,\boldsymbol{u}_m\right\}`$生成，求证：$`U^\perp = \left\{\boldsymbol{v}\in V|\left(\boldsymbol{v},\boldsymbol{u}_i\right)=0,i=1,2,\cdots,m\right\}`$。**

记$`S = \left\{\boldsymbol{v}\in V|\left(\boldsymbol{v},\boldsymbol{u}_i\right)=0,i=1,2,\cdots,m\right\}`$。

根据定义，$`U^\perp = \left\{\boldsymbol{v}|\left(\boldsymbol{v},\boldsymbol{u}\right)=0,\forall\boldsymbol{u}\in U\right\}`$。  
因为$`U`$由向量组$`\left\{\boldsymbol{u}_1,\boldsymbol{u}_2,\cdots,\boldsymbol{u}_m\right\}`$生成，所以存在$`\boldsymbol{u}_0\in U`$，满足$`\boldsymbol{u}_0 = k_1\boldsymbol{u}_1 + k_2\boldsymbol{u}_2 + \cdots + k_m\boldsymbol{u}_m,k_i\ne 0\left(i=1,2,\cdots,m\right)`$。  
用$`\boldsymbol{u}_0`$代入定义，则任意$`\boldsymbol{v}\in U^\perp`$满足  
$`\begin{split}
	\left(\boldsymbol{v},\boldsymbol{u}_0\right) 
	&= 0 \\
	&= \left(\boldsymbol{v},k_1\boldsymbol{u}_1 + k_2\boldsymbol{u}_2 + \cdots + k_m\boldsymbol{u}_m\right) \\
	&= \overline{k_1}\left(\boldsymbol{v},\boldsymbol{u}_1\right) + \overline{k_2}\left(\boldsymbol{v},\boldsymbol{u}_2\right) + \cdots + \overline{k_m}\left(\boldsymbol{v},\boldsymbol{u}_m\right)
\end{split}`$  
因为$`k_i\ne 0\left(i=1,2,\cdots,m\right)`$，所以$`\left(\boldsymbol{v},\boldsymbol{u}_i\right)=0\left(i=1,2,\cdots,m\right)`$。所以$`\boldsymbol{v}\in S`$。  
所以$`U^\perp\subseteq S`$。
  
因为$`U`$由向量组$`\left\{\boldsymbol{u}_1,\boldsymbol{u}_2,\cdots,\boldsymbol{u}_m\right\}`$生成，所以任意$`\boldsymbol{u}\in U`$一定存在分解$`\boldsymbol{u} = l_1\boldsymbol{u}_1 + l_2\boldsymbol{u}_2 + \cdots + l_m\boldsymbol{u}_m`$。  
任取$`\boldsymbol{w}\in S`$，$`\boldsymbol{w}`$满足$`\left(\boldsymbol{w},\boldsymbol{u}_i\right)=0\left(i=1,2,\cdots,m\right)`$。  
所以对任意$`\boldsymbol{u}\in U`$，有  
$`\begin{split}
	\left(\boldsymbol{w},\boldsymbol{u}\right) 
	&= \left(\boldsymbol{w},l_1\boldsymbol{u}_1 + l_2\boldsymbol{u}_2 + \cdots + l_m\boldsymbol{u}_m\right) \\
	&= \overline{l_1}\left(\boldsymbol{w},\boldsymbol{u}_1\right) + \overline{l_2}\left(\boldsymbol{w},\boldsymbol{u}_2\right) + \cdots + \overline{l_m}\left(\boldsymbol{w},\boldsymbol{u}_m\right) \\
	&= 0
\end{split}`$  
所以$`\boldsymbol{w}\in U^\perp`$。  
所以$`S\subseteq U^\perp`$。
  
所以$`U^\perp = S = \left\{\boldsymbol{v}\in V|\left(\boldsymbol{v},\boldsymbol{u}_i\right)=0,i=1,2,\cdots,m\right\}`$。


---

### 总复习 9
#### 9.r.6
**设$`\boldsymbol{A}`$为$`m\times n`$实矩阵，齐次线性方程组$`\boldsymbol{Ax}=\boldsymbol{0}`$的解空间为$`U`$，求$`U^\perp`$适合的线性方程组。**

$`U = \mathrm{null}\boldsymbol{A} = \left\{\boldsymbol{x}\in\mathbb{R}^n|\boldsymbol{A}\boldsymbol{x} = \boldsymbol{0}\right\}`$。  
记$`\mathrm{rank}\boldsymbol{A} = r`$，则$`\dim{U} = \dim{\mathrm{R}^n} - \mathrm{rank}\boldsymbol{A} = n-r`$。  
设$`\boldsymbol{k}_1,\boldsymbol{k}_2,\cdots,\boldsymbol{k}_{n-r}`$是$`U`$的一组基，则$`U^\perp = \left\{\boldsymbol{v}\in\mathbb{R}^n|\left(\boldsymbol{v},\boldsymbol{k}_i\right)=0,i=1,2,\cdots,n-r\right\}`$。  
考虑矩阵$`\boldsymbol{K} = \begin{pmatrix}
	\boldsymbol{k}_1^\mathrm{T} \\
	\boldsymbol{k}_2^\mathrm{T} \\
	\cdots \\
	\boldsymbol{k}_{n-r}^\mathrm{T}
\end{pmatrix}`$，有$`\boldsymbol{Kx} = \begin{pmatrix}
	\boldsymbol{k}_1^\mathrm{T}\boldsymbol{x} \\
	\boldsymbol{k}_2^\mathrm{T}\boldsymbol{x} \\
	\vdots \\
	\boldsymbol{k}_{n-r}^\mathrm{T}\boldsymbol{x}
\end{pmatrix} = \begin{pmatrix}
	\left(\boldsymbol{k}_1,\boldsymbol{x}\right) \\
	\left(\boldsymbol{k}_2,\boldsymbol{x}\right) \\
	\vdots \\
	\left(\boldsymbol{k}_{n-r},\boldsymbol{x}\right)
\end{pmatrix}`$。  
任取$`\boldsymbol{v}\in U^\perp`$，有$`\boldsymbol{Kv} = \begin{pmatrix}
	\left(\boldsymbol{k}_1,\boldsymbol{x}\right) \\
	\left(\boldsymbol{k}_2,\boldsymbol{x}\right) \\
	\vdots \\
	\left(\boldsymbol{k}_{n-r},\boldsymbol{x}\right)
\end{pmatrix} = \begin{pmatrix}
	0 \\
	0 \\
	\vdots \\
	0
\end{pmatrix} = \boldsymbol{0}`$。  
所以$`U^\perp`$适合的方程组是$`\begin{pmatrix}
	\boldsymbol{k}_1^\mathrm{T} \\
	\boldsymbol{k}_2^\mathrm{T} \\
	\vdots \\
	\boldsymbol{k}_{n-r}^\mathrm{T}
\end{pmatrix}\boldsymbol{v} = \boldsymbol{0}`$，其中$`\left\{\boldsymbol{k}_i\left(i=1,2,\cdots,n-r\right)\right\}`$是$`U`$的零空间的一组基。


***延伸***：
**设$`\boldsymbol{A}`$为$`m\times n`$复矩阵，齐次线性方程组$`\boldsymbol{Ax}=\boldsymbol{0}`$的解空间为$`U`$，求$`U^\perp`$适合的线性方程组。**

在复空间，$`U = \left\{\boldsymbol{x}\in\mathbb{C}^n|\boldsymbol{A}\boldsymbol{x} = \boldsymbol{0}\right\}`$。  
由于酉空间中$`\left(\boldsymbol{k}_i,\boldsymbol{x}\right) = \boldsymbol{k}_i^\mathrm{H}\boldsymbol{x} = \overline{\boldsymbol{k}_i}^\mathrm{T}\boldsymbol{x}`$，所以$`\boldsymbol{K}`$需改为$`\begin{pmatrix}
	\boldsymbol{k}_1^\mathrm{H} \\
	\boldsymbol{k}_2^\mathrm{H} \\
	\cdots \\
	\boldsymbol{k}_{n-r}^\mathrm{H}
\end{pmatrix}`$。  
所以$`U^\perp`$适合的方程组是$`\begin{pmatrix}
	\boldsymbol{k}_1^\mathrm{H} \\
	\boldsymbol{k}_2^\mathrm{H} \\
	\vdots \\
	\boldsymbol{k}_{n-r}^\mathrm{H}
\end{pmatrix}\boldsymbol{v} = \boldsymbol{0}`$，其中$`\left\{\boldsymbol{k}_i\left(i=1,2,\cdots,n-r\right)\right\}`$是$`U`$的零空间的一组基。
